<!DOCTYPE html>
<html height="100%">

<head>
    <meta charset="utf-8">
    <!-- dummy Symbol polyfill -->
    <script>
        if (typeof (Symbol) === "undefined") { window.Symbol = function (arg) { return arg; } }
    </script>
    <script src="https://unpkg.com/umbrellajs"></script>
    <!-- <script src="./src/bundle.js"></script> -->
</head>

<body min-height="100%">

    <object id="board" data="board.svg" type="image/svg+xml" height="100%" width="100%">
    </object>
   
    <script>
        u("#board").on("load", function () {
            let doc = this.contentDocument;
            let svg = doc.documentElement;
            u(svg).on("mousedown", mousedown, false);
            u(svg).on("mouseup", mouseup, false);
            u(svg).on("mousemove", mousemove, false);

            u('use[index="0"]', svg).attr("fill", "pink");
        });

        
        function mousedown(e) {
            console.log(e);
        }

        function mouseup(e) {
            console.log(e);
            u(e.target).attr("stroke", "pink");
        }

        function mousemove(e) {
            var element = e.target;

            disableAllSelHoles(element);
            if (element && u(element).attr("xlink:href") == "#hole" && u(element).attr("class") != "selVisible") {
                u(element).attr("class", "selVisible");
                console.log(u(element).attr("class"));
            }
        }

        function getSVGElement() {
            return u("#board").nodes[0].contentDocument.documentElement;
        }

        function disableAllSelHoles(selElement) {
            var selHoles = u('use.selVisible', getSVGElement());
            console.log(selHoles);
            selHoles.each(function (element) {
                if (element !== selElement) {
                    element.setAttribute("class", "selHidden");
                    console.log(u(element).attr("class"));
                }
            }, this);
        }
    </script>
</body>

</html>